---
title: sum-of-subarray-minimums
difficulty: Medium
date: 2023-11-27 11:44:49
url: https://leetcode.cn/problems/sum-of-subarray-minimums/
tags:
    - 单调栈
    - DP
---
# [907. 子数组的最小值之和](https://leetcode.cn/problems/sum-of-subarray-minimums/)
## 描述
给定一个整数数组 ``arr``，找到 ``min(b)`` 的总和，其中 ``b`` 的范围为 ``arr`` 的每个（连续）子数组。

由于答案可能很大，因此 **返回答案模 ``10^9 + 7``**。


## 样例
### 示例 1：

```
输入：arr = [3,1,2,4]
输出：17
解释：
子数组为 [3]，[1]，[2]，[4]，[3,1]，[1,2]，[2,4]，[3,1,2]，[1,2,4]，[3,1,2,4]。 
最小值为 3，1，2，4，1，1，2，1，1，1，和为 17。
```

### 示例 2：

```
输入：arr = [11,81,94,43,3]
输出：444
```


## 限制

- 1 <= `arr.length` <= 3 * 10<sup>4</sup>
- 1 <= `arr[i]` <= 3 * 10<sup>4</sup>


## [思考](./code.cpp)
单调栈

计算每个数在多少子区间中是最小值，进而统计每个数的贡献值。
即求数组中当前元素 `x` 左边第一个小于 `x` 的元素以及右边第一个小于等于 `x` 的元素。注意到为了防止重复计算，设定左边必须严格小于、右边小于等于`x`。

实现参考了 [828. 题解2](../828/solution2.cpp) 统计子区间的方法